## Пакет java.nio

Java NIO = New IO / Non-blocking IO

Пакет java.nio также предназначен для работы с вводом-выводом данных и работы с файловой системой.

В нём также есть классы для работы с файлами (аналог класса File)
В классе nio.Files есть набор статических методов для работы с файлами: создание, копирование, переименовывание и так 
далее. 

Основные составляющие пакета nio API:
- Каналы
- Буферы
- Селекторы

Канал - это аналог потока (сразу входящего и исходящего).
Можно осуществлять и чтение из канала, и запись в канал.
По умолчанию чтение и запись происходят последовательно. Но можно сделать так, чтобы чтение и запись осуществлялись 
асинхронно.

Каналы всегда пишут в буфер и читают из буфера.
Каналы могут быть созданы на основе классов
- FileChannel - для работы с файлами
- DatagramChannel - для передачи данных по UDP протоколу
- SocketChannel - для передачи данных по TCP протоколу. Используется со стороны клиента, если нужно передавать данные 
    по TCP протоколу
- ServerSocketChannel - используется для работы со стороны сервера. Работает и с TCP, и с UDP. Ожидает клиентского 
подключения, и при подключении воспроизводит его канал.

Канал всегда работает с буфером:
Чтение: Source -> buffer -> Java App
Запись: Source <- buffer <- Java App
без буфера использовать каналы невозможно.

Буфер нужно постоянно настраивать:
создать его, положить в него данные, прочитать из него данные, настроить его для дальнейшей работы.
Буфер может хранить определённый тип данных:
- ByteBuffer
- CharBuffer
- DoubleBuffer
- FloatBuffer
- IntBuffer
- LongBuffer
- ShortBuffer

[NIOBuffer](NioBufferDemo.java)

Когда создаётся буфер - ему задаётся ёмкость (начальная). В дальнейшем она неизменна.

    ByteBuffer buffer = ByteBuffer.allocate(16);

----

## Assert

assert - вспомогательный инструмент для разработки кода.
assert - это утверждение. Применяется для выражения с булевским значением.
Если утверждение не верно, assert выбросит исключение (если оно не обработано - прервётся выполнение программы).

по умолчанию assert-ы игнорируются.
Чтобы assert-ы работали, нужно в конфигурации приложения, в VM Options указать ключ `-ea`

В продакшен версии assert-ы должны быть выключены, и в исходном коде их быть не должно.
  
---

## Селекторы

Селекторы - это в некотором смысле альтернатива многопоточности.
Каждый канал работает с каким-то (одним) ресурсом.
Селектор как часть NIO API может работать с несколькими каналами.
Селектор следит за тем, что происходит за тем что происходит в каждом из каналов, с которыми он связан. Примеры событий:
- появляется данные (и их нужно считать)
- нужно записать данные
- получено новое подключение (новый клиент подключился)

Селектор обнаруживает событие, определяет какое это событие произошло и выполняет определённые действия - это уже 
задача программиста: если одно событие - выполнить один блок кода; если второе - другой.

Селектор позволяет потоку обслуживать несколько каналов.  
Селектор подписывается на событие (или несколько событий) в канале.  
Типы событий:
- Connect - пришло подключение
- Accept - произведено соединение
- Read - пришли данные в канал (их нужно считать)
- Write - нужно записать данные в канал.

Если событие наступит, селектор будет проинформирован об этом и сможет отреагировать необходимым образом.